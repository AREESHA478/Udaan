<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Career Test - Udaan</title>
    <link rel="stylesheet" href="/css/theme.css">
    <link rel="stylesheet" href="/css/career-test.css">
    <link rel="stylesheet" href="/css/auth-styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body data-theme="light">

    <header>
        <nav class="navbar">
            <div class="logo">Udaan</div>
            <ul class="nav-links">
                <li><a href="/">Home</a></li>
                <!-- Career Test Link -->
                <li sec:authorize="!isAuthenticated()"><a href="#" onclick="event.preventDefault(); openModal('signin')" title="Please login to take the test">Career Test</a></li>
                <li sec:authorize="isAuthenticated()"><a href="/career-test">Career Test</a></li>
                
                <!-- Resources Link -->
                <li sec:authorize="!isAuthenticated()"><a href="#" onclick="event.preventDefault(); openModal('signin')" title="Please login to view resources">Resources</a></li>
                <li sec:authorize="isAuthenticated()"><a href="/resources">Resources</a></li>

                <li><a href="/about">About</a></li>
                <li><a href="/contact">Contact</a></li>
            </ul>
            <div class="theme-toggle-container">
                <button id="theme-toggle-btn" class="btn-toggle">
                    <i class="fas fa-moon"></i>
                </button>
            </div>
            <div class="user-profile">
                <!-- If user is authenticated, show name and link to dashboard -->
                <div sec:authorize="isAuthenticated()" class="user-info">
                   <a th:href="@{/dashboard}" class="name-icon" th:text="${loggedInUserFirstName != null and loggedInUserFirstName.length() > 0 ? loggedInUserFirstName.substring(0, 1) : '?'}"></a>
                </div>
                <!-- If user is not authenticated, show login icon -->
                <i sec:authorize="!isAuthenticated()" class="fas fa-user-circle"></i>
            </div>
        </nav>
    </header>

    <main class="career-test-content">
        <div class="test-container">
            <h1>Find Your Ideal Career</h1>
            <p>Answer a few questions to discover career paths that match your skills and interests.</p>

            <form id="career-test-form" action="/career-results" method="post">
                <!-- Step 1: Select Education Level -->
                <div class="form-group">
                    <label for="education-level">Select Your Current Education Level:</label>
                    <select id="education-level" name="educationLevel" class="form-control" required>
                        <option value="" disabled selected>-- Please Choose --</option>
                        <option value="matric">Matriculation / O-Levels</option>
                        <option value="inter">Intermediate / A-Levels</option>
                        <option value="uni">University Student</option>
                    </select>
                </div>

                <!-- Questions for Matric Students -->
                <div id="matric-questions" class="question-set" style="display: none;">
                    <h3>Matriculation Level Questions</h3>
                    <p>Which subjects do you enjoy the most in school?</p>
                    <div class="checkbox-group">
                        <label><input type="checkbox" name="skill" value="science"> Understanding how things work, experimenting (Physics, Chemistry)</label>
                        <label><input type="checkbox" name="skill" value="biology"> Learning about living things and plants (Biology)</label>
                        <label><input type="checkbox" name="skill" value="computer"> Solving problems or creating things on a computer (Computer Science)</label>
                        <label><input type="checkbox" name="skill" value="arts"> Drawing, painting, or creating new designs (Arts & Drawing)</label>
                        <label><input type="checkbox" name="skill" value="commerce"> Learning about numbers and business basics (Commerce)</label>
                    </div>
                </div>

                <!-- Questions for Intermediate Students -->
                <div id="inter-questions" class="question-set" style="display: none;">
                    <h3>Intermediate Level Questions</h3>
                    <p>What are your strongest subjects or interests in college?</p>
                    <div class="checkbox-group">
                        <label><input type="checkbox" name="skill" value="pre-eng"> Building machines, structures, or technology (Pre-Engineering)</label>
                        <label><input type="checkbox" name="skill" value="pre-med"> Understanding the human body and treating diseases (Pre-Medical)</label>
                        <label><input type="checkbox" name="skill" value="ics"> Creating software, websites, or mobile apps (ICS)</label>
                        <label><input type="checkbox" name="skill" value="i-com"> Managing businesses and handling finances (I.Com)</label>
                        <label><input type="checkbox" name="skill" value="humanities"> Studying society, law, or human behavior (Humanities)</label>
                    </div>
                </div>

                <!-- Questions for University Students -->
                <div id="uni-questions" class="question-set" style="display: none;">
                    <h3>University Level Questions</h3>
                    <p>What is your field of study or area of passion at university?</p>
                    <div class="checkbox-group">
                        <label><input type="checkbox" name="skill" value="software"> Building new software and AI systems (Software & AI)</label>
                        <label><input type="checkbox" name="skill" value="business-mgt"> Managing companies and selling products (Business & Management)</label>
                        <label><input type="checkbox" name="skill" value="medical-health"> Caring for patients or conducting medical research (Medical & Health)</label>
                        <label><input type="checkbox" name="skill" value="creative-design"> Creating beautiful visuals and digital experiences (Creative Arts & Design)</label>
                        <label><input type="checkbox" name="skill" value="social-sciences"> Solving social problems or practicing law (Social Sciences & Law)</label>
                    </div>
                </div>

                <button type="submit" class="btn btn-primary" id="submit-btn" style="display: none;">Get Career Suggestions</button>
            </form>
        </div>
    </main>

    <footer>
        <div class="footer-content">
            <div class="footer-info">
                <p>Empowering students to discover their perfect career path through AI-driven guidance.</p>
            </div>
            <div class="quick-links">
                <h4>Quick Links</h4>
                <ul>
                    <li><a href="/">Home</a></li>
                    <li><a href="/about">About</a></li>
                    <li><a href="/contact">Contact</a></li>
                </ul>
            </div>
            <div class="connect-with-us">
                <h4>Connect With Us</h4>
                <div class="social-icons">
                    <a href="#"><i class="fab fa-linkedin-in"></i></a>
                    <a href="#"><i class="fab fa-instagram"></i></a>
                    <a href="#"><i class="fab fa-facebook-f"></i></a>
                </div>
            </div>
        </div>
        <div class="copyright">
            &copy; 2025 Udaan. All rights reserved.
        </div>
    </footer>

    <script>
        document.getElementById('education-level').addEventListener('change', function() {
            // Hide all question sets
            document.querySelectorAll('.question-set').forEach(function(div) {
                div.style.display = 'none';
                // Uncheck all checkboxes when level changes
                div.querySelectorAll('input[type="checkbox"]').forEach(function(checkbox) {
                    checkbox.checked = false;
                });
            });

            // Get the selected value
            const selectedLevel = this.value;

            // Show the relevant question set and the submit button
            if (selectedLevel) {
                const questionSet = document.getElementById(selectedLevel + '-questions');
                if (questionSet) {
                    questionSet.style.display = 'block';
                }
                document.getElementById('submit-btn').style.display = 'block';
            } else {
                document.getElementById('submit-btn').style.display = 'none';
            }
        });
    </script>
    <script src="/js/toggle.js"></script>
    <script src="/js/auth-script.js"></script>

    <!-- Authentication Modal -->
    <div class="modal-overlay" id="auth-modal">
        <div class="auth-modal-content">
            <button class="close-btn" onclick="closeModal()">&times;</button>

            <!-- Sign Up Form (Initial View) -->
            <div id="signup-form" class="auth-form active">
                <h2>Create Account</h2>
                <button class="btn btn-social"><i class="fab fa-google"></i> Continue with Google</button>
                <div class="divider">OR</div>
                <form action="/signup" method="post">
                    <!-- Add this hidden input for CSRF token -->
                    <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
                    <div class="form-row">
                        <div class="form-group">
                            <label for="signup-firstName">First Name</label>
                            <input type="text" id="signup-firstName" name="firstName" placeholder="Enter your first name" required>
                        </div>
                        <div class="form-group">
                            <label for="signup-lastName">Last Name</label>
                            <input type="text" id="signup-lastName" name="lastName" placeholder="Enter your last name" required>
                        </div>
                    </div>
                    <label for="signup-email">Email</label>
                    <input type="email" id="signup-email" name="email" placeholder="Enter your email" required>
                    <label for="signup-password">Password</label>
                    <input type="password" id="signup-password" name="password" placeholder="Create a password" required>
                    <button type="submit" class="btn btn-primary" style="width:100%; margin-top: 15px;">Create Account</button>
                </form>
                <div class="auth-footer-link">
                    Already have an account? <a href="#" onclick="event.preventDefault(); showTab('signin')">Sign In</a>
                </div>
            </div>

            <!-- Sign In Form -->
            <div id="signin-form" class="auth-form">
                <h2>Welcome Back!</h2>
                <div th:if="${param.error}" class="auth-error-message" style="display: block;">
                    Something is wrong Email or Password
                </div>
                <form action="/login" method="post">
                    <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
                    <label for="signin-email">Email</label>
                    <input type="email" id="signin-email" name="username" placeholder="Enter your email" required>
                    <label for="signin-password">Password <a href="#" class="forgot-link">Forgot?</a></label>
                    <input type="password" id="signin-password" name="password" placeholder="Enter your password" required>
                    <button type="submit" class="btn btn-primary" style="width:100%; margin-top: 15px;">Sign In</button>
                </form>
                <div class="auth-footer-link">
                    Don't have an account? <a href="#" onclick="event.preventDefault(); showTab('signup')">Sign Up</a>
                </div>
            </div>
        </div>
    </div>
</body>
</html>
